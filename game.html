<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build-A-Bite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f8f9fa;  /* Changed to light background */
            margin: 0;
            padding: 0;
        }

        .game-container {
            width: 100%;
            max-width: 1000px; /* Made the container full width */
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
            min-height: 80vh; /* Allowing the container to take up more space */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .input-section, .main-content {
            text-align: center;
        }

        .input-section input {
            padding: 10px;
            margin: 10px;
            width: 80%;
            max-width: 400px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .difficulty-selection button {
            padding: 10px 20px;
            margin: 10px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .difficulty-selection button:hover {
            background-color: #5a6268;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .option-card {
            background: #f8f9fa;
            padding: 15px;
            text-align: center;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .option-card:hover {
            border-color: #007bff;
            transform: scale(1.05);
        }

        .selected {
            background-color: #007bff;
            color: white;
        }

        .action-btn {
            background: #28a745;
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            border: none;
            margin-top: 10px;
        }

        .score-summary {
            background: #ffc107;
            padding: 15px;
            margin-top: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .score-summary p {
            font-size: 18px;
            font-weight: bold;
        }

        .feedback {
            background-color: #ffeb3b;
            padding: 10px;
            border-radius: 5px;
            margin-top: 15px;
        }

        #scoreTab {
            display: none;
            background-color: #ffffff;
            padding: 15px;
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }

        #scoreTab h2 {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #scoreSummary {
            font-size: 18px;
            text-align: center;
        }

        .back-btn {
            background: #dc3545;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            margin-top: 15px;
            cursor: pointer;
            border: none;
        }

        .back-btn:hover {
            background-color: #c82333;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Input Section -->
        <div class="input-section" id="inputSection">
            <h1>üçΩÔ∏è Build-A-Bite</h1>
            <p>Craft Delicious Foods from Scratch to Success</p>
            <input type="text" id="name" placeholder="Enter your Name" />
            <input type="email" id="email" placeholder="Enter your Email" />
            
            <div class="difficulty-selection">
                <button onclick="selectDifficulty('beginner')">Beginner</button>
                <button onclick="selectDifficulty('intermediate')">Intermediate</button>
                <button onclick="selectDifficulty('expert')">Expert</button>
            </div>
        </div>

        <!-- Main Content Section -->
        <div class="main-content" id="gameContent" style="display: none;">
            <!-- Dynamic content will be inserted here -->
        </div>

        <!-- Score Tab -->
        <div id="scoreTab">
            <h2>Your Score</h2>
            <div id="scoreSummary"></div>
            <button class="action-btn" onclick="restartGame()">Play Again</button>
        </div>
    </div>

    <script>
        const gameData = {
            products: [
                { 
                    name: 'Plant-Based Meat', 
                    emoji: 'üçî', 
                    desc: 'A plant-based meat that mimics the taste and texture of traditional meat.' 
                },
                { 
                    name: '3D-Printed Food', 
                    emoji: 'üñ®Ô∏è', 
                    desc: 'Food created by 3D printing technology for custom shapes and designs.' 
                },
                { 
                    name: 'Vegan Cheese', 
                    emoji: 'üßÄ', 
                    desc: 'Dairy-free cheese made from plant-based ingredients.' 
                },
                { 
                    name: 'Kombucha', 
                    emoji: 'üçπ', 
                    desc: 'A fermented tea beverage with probiotics.' 
                },
                { 
                    name: 'Lab-Grown Meat', 
                    emoji: 'ü•©', 
                    desc: 'Meat grown in a lab without the need for animal slaughter.' 
                }
            ],
            ingredients: {
                'Plant-Based Meat': [
                    { name: 'Soy Protein', emoji: 'üå±', desc: 'A protein-rich ingredient, often used in plant-based foods.', correct: true },
                    { name: 'Pea Protein', emoji: 'üçÉ', desc: 'A plant-based protein often used in vegan products.', correct: true },
                    { name: 'Coconut Oil', emoji: 'ü••', desc: 'A plant-derived fat used for texture and moisture.', correct: true },
                    { name: 'Rice Flour', emoji: 'üçö', desc: 'A flour used as a binder or thickener in some food products.', correct: false },
                    { name: 'Chickpea Flour', emoji: 'üåæ', desc: 'A flour made from chickpeas, commonly used for binding.', correct: false },
                    { name: 'Lemon Extract', emoji: 'üçã', desc: 'Adds a tangy flavor to various food items.', correct: false },
                    { name: 'Carrot Extract', emoji: 'ü•ï', desc: 'A natural ingredient often used for color and flavor.', correct: true },
                    { name: 'Vegan Cheese', emoji: 'üßÄ', desc: 'A dairy-free cheese made from various plant-based ingredients.', correct: false },
                    { name: 'Seaweed', emoji: 'üåä', desc: 'A marine plant often used for texture in some dishes.', correct: false },
                    { name: 'Hemp Oil', emoji: 'üåø', desc: 'An oil derived from hemp seeds, used for fat content in food.', correct: false }
                ],
                '3D-Printed Food': [
                    { name: 'Chocolate', emoji: 'üç´', desc: 'A sweet ingredient used for various food designs.', correct: true },
                    { name: 'Algae Powder', emoji: 'üåø', desc: 'A nutrient-rich ingredient, often used for sustainable nutrition.', correct: true },
                    { name: 'Sugar', emoji: 'üç¨', desc: 'A sweet substance often used in food for flavor.', correct: true },
                    { name: 'Flour', emoji: 'üçö', desc: 'A common ingredient used in baking and food binding.', correct: true },
                    { name: 'Coconut Oil', emoji: 'ü••', desc: 'A fat used in various food products for texture and flavor.', correct: false },
                    { name: 'Butter', emoji: 'üßà', desc: 'A fatty substance used in cooking and baking.', correct: false },
                    { name: 'Natural Sweeteners', emoji: 'üçØ', desc: 'Sweeteners derived from natural sources, such as plants.', correct: true },
                    { name: 'Water', emoji: 'üíß', desc: 'A basic liquid used in almost all food preparation.', correct: true },
                    { name: 'Honey', emoji: 'üçØ', desc: 'A natural sweetener produced by bees.', correct: false },
                    { name: 'Lemon Juice', emoji: 'üçã', desc: 'A citrus fruit juice used for flavor and acidity.', correct: false }
                ],
                'Vegan Cheese': [
                    { name: 'Cashews', emoji: 'ü•ú', desc: 'A nut that is often blended into creamy products.', correct: true },
                    { name: 'Almond Milk', emoji: 'ü•õ', desc: 'A dairy-free milk made from almonds.', correct: true },
                    { name: 'Nutritional Yeast', emoji: 'üßÄ', desc: 'A yeast used for its cheesy flavor in plant-based products.', correct: true },
                    { name: 'Tapioca Starch', emoji: 'üçö', desc: 'A starch used to add texture and consistency in foods.', correct: true },
                    { name: 'Coconut Oil', emoji: 'ü••', desc: 'A fat derived from coconuts, often used for its creamy texture.', correct: true },
                    { name: 'Lemon Juice', emoji: 'üçã', desc: 'Adds acidity and tanginess to various recipes.', correct: true },
                    { name: 'Rice Flour', emoji: 'üçö', desc: 'A flour made from rice, often used in gluten-free recipes.', correct: false },
                    { name: 'Coconut Milk', emoji: 'ü••', desc: 'A creamy liquid made from coconut meat.', correct: false },
                    { name: 'Sugar', emoji: 'üç¨', desc: 'A sweet ingredient, not usually needed in vegan cheese.', correct: false },
                    { name: 'Pepper', emoji: 'üå∂Ô∏è', desc: 'A spice used for heat in food, but not typically in cheese.', correct: false }
                ],
                'Kombucha': [
                    { name: 'Black Tea', emoji: 'üçÇ', desc: 'A common tea used as the base for fermented beverages.', correct: true },
                    { name: 'Sugar', emoji: 'üç¨', desc: 'A sweet ingredient that feeds fermentation cultures.', correct: true },
                    { name: 'Ginger', emoji: 'üå∂Ô∏è', desc: 'A root used for its spicy flavor in beverages.', correct: true },
                    { name: 'Lemon', emoji: 'üçã', desc: 'A citrus fruit used for its refreshing flavor.', correct: true },
                    { name: 'Green Tea', emoji: 'üçÉ', desc: 'A variety of tea used in some fermented drinks.', correct: true },
                    { name: 'SCOBY', emoji: 'ü¶†', desc: 'A microorganism used in fermentation processes.', correct: true },
                    { name: 'Honey', emoji: 'üçØ', desc: 'A natural sweetener, though not used in kombucha fermentation.', correct: false },
                    { name: 'Cinnamon', emoji: 'üç™', desc: 'A spice used for flavor, but not common in kombucha.', correct: false },
                    { name: 'Artificial Sweetener', emoji: 'üç¨', desc: 'A non-sugar sweetener, not recommended for fermentation.', correct: false },
                    { name: 'Grapefruit', emoji: 'üçä', desc: 'A citrus fruit, but not typically used in kombucha.', correct: false }
                ],
                'Lab-Grown Meat': [
                    { name: 'Animal Cells', emoji: 'üêÑ', desc: 'Cells used for cultivating meat in labs.', correct: true },
                    { name: 'Growth Medium', emoji: 'üß´', desc: 'A nutrient solution used to help cells grow.', correct: true },
                    { name: 'Fetal Bovine Serum', emoji: 'ü©∏', desc: 'A common growth medium for cultivating animal cells.', correct: true },
                    { name: 'Pea Protein', emoji: 'üå±', desc: 'A plant-based protein used in alternative meats.', correct: false },
                    { name: 'Coconut Oil', emoji: 'ü••', desc: 'A fat source, but not related to lab-grown meat.', correct: false },
                    { name: 'Carrot Extract', emoji: 'ü•ï', desc: 'A natural ingredient used for color or flavor.', correct: false },
                    { name: 'Seaweed', emoji: 'üåä', desc: 'Used in some products for texture, but not in lab-grown meat.', correct: false },
                    { name: 'Soy Lecithin', emoji: 'üå±', desc: 'A common emulsifier in various food products.', correct: true },
                    { name: 'Rice Flour', emoji: 'üçö', desc: 'A starch used as a binder in many recipes.', correct: false },
                    { name: 'Hemp Oil', emoji: 'üåø', desc: 'An oil used for fat content, not related to lab-grown meat.', correct: false }
                ]
            },
            processes: [
                'Nutrient Encapsulation', 'Fermentation', 'Cold Pressing', 'Flavoring', 'Binding', 
                'Extrusion Cooking', 'Molding', 'Blending', 'Shaping', 'Slicing'
            ],
            machinery: [
                'Extruder', 'Bioreactor', 'Molding Press', 'Blender', 'Fermentation Vessel', 
                'Freeze Dryer', 'Packaging Machine', 'Cell Harvester', 'Slicer', 'Grill Machine'
            ]
        };

        let selectedDifficulty = null;
        let selectedProduct = null;
        let score = 0;
        let totalQuestions = 0; // Track the total questions for each difficulty
        let currentStep = 'product'; // Track the current step (product, ingredient, process, machinery)
        let wrongChoices = [];

        // Shuffle function to randomize options
        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]]; // Swap elements
            }
        }

        // Show product selection
        function showProductSelection() {
            const section = document.createElement('div');
            section.classList.add('section');
            section.innerHTML = `
                <h2>Select a Product</h2>
                <div class="options-grid">
                    ${gameData.products.map((product, index) => `
                        <div class="option-card" id="product-${index}" onclick="selectProduct('${product.name}', ${index})">
                            <span class="option-emoji">${product.emoji}</span>
                            <div class="option-title">${product.name}</div>
                            <div class="option-desc">${product.desc}</div>
                        </div>
                    `).join('')}
                </div>
                <button class="action-btn" onclick="nextStep()">Next</button>
            `;
            document.getElementById('gameContent').innerHTML = section.outerHTML;
        }

        // Select Product and highlight
        function selectProduct(productName, index) {
		    const clickSound = document.getElementById("clickSound"); // Get the sound element
		    clickSound.play();  // Play the sound when a product is selected
		    selectedProduct = gameData.products.find(product => product.name === productName);
		    const selectedCard = document.getElementById(`product-${index}`);
		    const allCards = document.querySelectorAll('.option-card');
		    allCards.forEach(card => card.classList.remove('selected'));
		    selectedCard.classList.add('selected');        
		}

        // Show ingredient selection after product selection
        function showIngredientSelection() {
            shuffleArray(gameData.ingredients[selectedProduct.name]); // Shuffle ingredients
            totalQuestions = gameData.ingredients[selectedProduct.name].length;  // Set the total questions for this step
            const section = document.createElement('div');
            section.classList.add('section');
            section.innerHTML = `
                <h2>Select Ingredients for ${selectedProduct.name}</h2>
                <div class="options-grid">
                    ${gameData.ingredients[selectedProduct.name].map((item, index) => `
                        <div class="option-card" id="ingredient-${index}" onclick="toggleSelection(this, ${item.correct}, '${item.name}')">
                            <span class="option-emoji">${item.emoji}</span>
                            <div class="option-title">${item.name}</div>
                            <div class="option-desc">${item.desc}</div>
                        </div>
                    `).join('')}
                </div>
                <button class="action-btn" onclick="nextStep()">Next</button>
                <button class="back-btn" onclick="previousStep()">Back</button>
            `;
            document.getElementById('gameContent').innerHTML = section.outerHTML;
        }

        // Toggle selection of ingredients
        function toggleSelection(card, isCorrect, itemName) {
    		const clickSound = document.getElementById("clickSound"); // Get the sound element
		    clickSound.play();  // Play the sound when an ingredient is selected
		    card.classList.toggle('selected');
		    card.setAttribute("data-correct", isCorrect);
		    if (isCorrect) {
		        score += 1;
		    } else {
		        wrongChoices.push(itemName);
		    }
		}


        // Show process selection for Intermediate or Expert
        function showProcessSelection() {
            shuffleArray(gameData.processes); // Shuffle processes
            totalQuestions += gameData.processes.length; // Add process questions to total
            const section = document.createElement('div');
            section.classList.add('section');
            section.innerHTML = `
                <h2>Select Processes for ${selectedProduct.name}</h2>
                <div class="options-grid">
                    ${gameData.processes.map((process, index) => `
                        <div class="option-card" id="process-${index}" onclick="toggleProcessSelection(this, true, '${process}')">
                            <div class="option-title">${process}</div>
                        </div>
                    `).join('')}
                </div>
                <button class="action-btn" onclick="nextStep()">Next</button>
                <button class="back-btn" onclick="previousStep()">Back</button>
            `;
            document.getElementById('gameContent').innerHTML = section.outerHTML;
        }

        // Toggle selection for processes
        function toggleProcessSelection(card, isCorrect, process) {
            card.classList.toggle('selected');
            card.setAttribute("data-correct", isCorrect);
            if (isCorrect) {
                score += 1;
            } else {
                wrongChoices.push(process); // Record incorrect choices
            }
        }

        // Show machinery selection for Expert
        function showMachinerySelection() {
            shuffleArray(gameData.machinery); // Shuffle machinery
            totalQuestions += gameData.machinery.length; // Add machinery questions to total
            const section = document.createElement('div');
            section.classList.add('section');
            section.innerHTML = `
                <h2>Select Machinery for ${selectedProduct.name}</h2>
                <div class="options-grid">
                    ${gameData.machinery.map((machinery, index) => `
                        <div class="option-card" id="machinery-${index}" onclick="toggleMachinerySelection(this, true, '${machinery}')">
                            <div class="option-title">${machinery}</div>
                        </div>
                    `).join('')}
                </div>
                <button class="action-btn" onclick="nextStep()">Next</button>
                <button class="back-btn" onclick="previousStep()">Back</button>
            `;
            document.getElementById('gameContent').innerHTML = section.outerHTML;
        }

        // Toggle selection for machinery
        function toggleMachinerySelection(card, isCorrect, machinery) {
            card.classList.toggle('selected');
            card.setAttribute("data-correct", isCorrect);
            if (isCorrect) {
                score += 1;
            } else {
                wrongChoices.push(machinery); // Record incorrect choices
            }
        }

        // Show score tab and feedback
        function showScoreTab() {
            document.getElementById('gameContent').style.display = 'none';
            document.getElementById('scoreTab').style.display = 'block';

            let percentage = (score / totalQuestions) * 100;
            let feedbackHTML = `<p>Your score: ${percentage.toFixed(2)}/100</p>`;
            if (wrongChoices.length > 0) {
                feedbackHTML += `<p>Incorrect selections: ${wrongChoices.join(', ')}</p>`;
            } else {
                feedbackHTML += `<p>Great job! No wrong choices!</p>`;
            }
            document.getElementById('scoreSummary').innerHTML = feedbackHTML;
        }

        // Handle "Next" step based on the game state
        function nextStep() {
            if (currentStep === 'product') {
                showIngredientSelection();
                currentStep = 'ingredient';
            } else if (currentStep === 'ingredient') {
                if (selectedDifficulty === 'intermediate' || selectedDifficulty === 'expert') {
                    showProcessSelection();
                    currentStep = 'process';
                } else {
                    showScoreTab();
                    currentStep = 'score';
                }
            } else if (currentStep === 'process') {
                if (selectedDifficulty === 'expert') {
                    showMachinerySelection();
                    currentStep = 'machinery';
                } else {
                    showScoreTab();
                    currentStep = 'score';
                }
            } else if (currentStep === 'machinery') {
                showScoreTab();
                currentStep = 'score';
            }
        }

        // Handle "Back" to previous step
        function previousStep() {
            if (currentStep === 'ingredient') {
                showProductSelection();
                currentStep = 'product';
            } else if (currentStep === 'process') {
                showIngredientSelection();
                currentStep = 'ingredient';
            } else if (currentStep === 'machinery') {
                showProcessSelection();
                currentStep = 'process';
            }
        }

// Start the game based on the selected difficulty
function selectDifficulty(level) {
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;

    if (!name || !email) {
        alert('Please provide your Name and Email.');
        return;
    }

    // Hide the input section and show the game content
    document.getElementById('inputSection').style.display = 'none';
    document.getElementById('gameContent').style.display = 'block';

    selectedDifficulty = level;
    currentStep = 'product'; // Start from product selection

    // Initialize Timer based on difficulty level
    let timer = 30;  // Set timer for 30 seconds (can be adjusted based on difficulty)
    if (selectedDifficulty === 'intermediate') {
        timer = 45; // Intermediate gets 45 seconds
    } else if (selectedDifficulty === 'expert') {
        timer = 60; // Expert gets 60 seconds
    }

    let countdown; // Timer interval variable

    // Create the timer element and add it to the game content
    const timerDisplay = document.createElement('p');
    timerDisplay.setAttribute('id', 'timer');
    timerDisplay.style.fontSize = '24px'; // Ensure the text is large enough to see
    timerDisplay.style.fontWeight = 'bold'; // Bold the timer text
    timerDisplay.style.marginBottom = '20px'; // Add spacing below the timer
    timerDisplay.style.textAlign = 'center'; // Center the timer text
    document.getElementById('gameContent').prepend(timerDisplay); // Prepend it to gameContent

    // Start the timer function
    function startTimer() {
        countdown = setInterval(function() {
            timerDisplay.textContent = `Time Left: ${timer}s`;  // Update the text
            if (timer <= 0) {
                clearInterval(countdown);
                showScoreTab(); // Move to score tab when time is up
            }
            timer--; // Decrease the timer each second
        }, 1000);
    }

    // Start the timer when the game begins
    startTimer();

    // Show product selection
    showProductSelection(); // This ensures the game moves to product selection

    // Function to update the leaderboard
    function updateLeaderboard() {
        const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
        leaderboard.push({ name: document.getElementById('name').value, score: score });
        leaderboard.sort((a, b) => b.score - a.score); // Sort by score (descending order)
        localStorage.setItem('leaderboard', JSON.stringify(leaderboard));

        // Display the leaderboard
        const leaderboardContent = document.getElementById('leaderboardContent');
        leaderboardContent.innerHTML = leaderboard.map(entry => `<p>${entry.name}: ${entry.score}</p>`).join('');
    }

    // Call the updateLeaderboard function when the game ends (inside showScoreTab)
    updateLeaderboard();
}

// Show product selection function
function showProductSelection() {
    const section = document.createElement('div');
    section.classList.add('section');
    section.innerHTML = `
        <h2>Select a Product</h2>
        <div class="options-grid">
            ${gameData.products.map((product, index) => `
                <div class="option-card" id="product-${index}" onclick="selectProduct('${product.name}', ${index})">
                    <span class="option-emoji">${product.emoji}</span>
                    <div class="option-title">${product.name}</div>
                    <div class="option-desc">${product.desc}</div>
                </div>
            `).join('')}
        </div>
        <button class="action-btn" onclick="nextStep()">Next</button>
    `;
    document.getElementById('gameContent').innerHTML = section.outerHTML;
}

// Select Product and highlight
function selectProduct(productName, index) {
    selectedProduct = gameData.products.find(product => product.name === productName);
    const selectedCard = document.getElementById(`product-${index}`);
    const allCards = document.querySelectorAll('.option-card');
    allCards.forEach(card => card.classList.remove('selected'));
    selectedCard.classList.add('selected');        
}

// Show ingredient selection after product selection
function showIngredientSelection() {
    shuffleArray(gameData.ingredients[selectedProduct.name]); // Shuffle ingredients
    totalQuestions = gameData.ingredients[selectedProduct.name].length;  // Set the total questions for this step
    const section = document.createElement('div');
    section.classList.add('section');
    section.innerHTML = `
        <h2>Select Ingredients for ${selectedProduct.name}</h2>
        <div class="options-grid">
            ${gameData.ingredients[selectedProduct.name].map((item, index) => `
                <div class="option-card" id="ingredient-${index}" onclick="toggleSelection(this, ${item.correct}, '${item.name}')">
                    <span class="option-emoji">${item.emoji}</span>
                    <div class="option-title">${item.name}</div>
                    <div class="option-desc">${item.desc}</div>
                </div>
            `).join('')}
        </div>
        <button class="action-btn" onclick="nextStep()">Next</button>
        <button class="back-btn" onclick="previousStep()">Back</button>
    `;
    document.getElementById('gameContent').innerHTML = section.outerHTML;
}

// Toggle selection of ingredients
function toggleSelection(card, isCorrect, itemName) {
    card.classList.toggle('selected');
    card.setAttribute("data-correct", isCorrect);
    if (isCorrect) {
        score += 1;
    } else {
        wrongChoices.push(itemName);
    }
}

// Handle "Next" step based on the game state
function nextStep() {
    if (currentStep === 'product') {
        showIngredientSelection();
        currentStep = 'ingredient';
    } else if (currentStep === 'ingredient') {
        if (selectedDifficulty === 'intermediate' || selectedDifficulty === 'expert') {
            showProcessSelection();
            currentStep = 'process';
        } else {
            showScoreTab();
            currentStep = 'score';
        }
    } else if (currentStep === 'process') {
        if (selectedDifficulty === 'expert') {
            showMachinerySelection();
            currentStep = 'machinery';
        } else {
            showScoreTab();
            currentStep = 'score';
        }
    } else if (currentStep === 'machinery') {
        showScoreTab();
        currentStep = 'score';
    }
}

// Handle "Back" to previous step
function previousStep() {
    if (currentStep === 'ingredient') {
        showProductSelection();
        currentStep = 'product';
    } else if (currentStep === 'process') {
        showIngredientSelection();
        currentStep = 'ingredient';
    } else if (currentStep === 'machinery') {
        showProcessSelection();
        currentStep = 'process';
    }
}

// Show score tab and feedback
function showScoreTab() {
    document.getElementById('gameContent').style.display = 'none';
    document.getElementById('scoreTab').style.display = 'block';

    let percentage = (score / totalQuestions) * 100;
    let feedbackHTML = `<p>Your score: ${percentage.toFixed(2)}/100</p>`;
    if (wrongChoices.length > 0) {
        feedbackHTML += `<p>Incorrect selections: ${wrongChoices.join(', ')}</p>`;
    } else {
        feedbackHTML += `<p>Great job! No wrong choices!</p>`;
    }
    document.getElementById('scoreSummary').innerHTML = feedbackHTML;
}

// Restart the game
function restartGame() {
    document.getElementById('scoreTab').style.display = 'none';
    document.getElementById('inputSection').style.display = 'block';
    document.getElementById('name').value = '';
    document.getElementById('email').value = '';
    wrongChoices = [];
    score = 0;
    currentStep = 'product';
}

        // Restart the game
        function restartGame() {
            document.getElementById('scoreTab').style.display = 'none';
            document.getElementById('inputSection').style.display = 'block';
            document.getElementById('name').value = '';
            document.getElementById('email').value = '';
            wrongChoices = [];
            score = 0;
            currentStep = 'product';
        }
    </script>

</body>
</html>
